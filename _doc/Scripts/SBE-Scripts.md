---
layout: doc
title: SBE-Scripts
permalink: /doc/Scripts/SBE-Scripts/
---
# SBE-Scripts

SBE-Scripts - it's our engine for additional work over [MSBuild](../MSBuild/) - conditions, subcommands, file operations, etc. by components.

*you can use this as an additional variant and/or if need a some features, for example, special for Visual Studio etc. all of that are not exists/available with [MSBuild](../MSBuild/)*

## Components

{% include doc/SBE-Scripts/Components.html %}

## Syntax

All commands and operations should be wrapped with container:

```java 

#[ ... ]
```

To escape an sequences use `#`: 

```java 

##[ ... ]
```

### Sample

Try execute this:

```java

#["
    Basic example
"]
#[var v = v1.2.3]
#[var log = $(TMP)/v.txt]

#[($(Configuration) ~= Deb || true)
{
    #[var tStart    = $([System.DateTime]::Parse("2015/10/01").ToBinary())]
    #[var tNow      = $([System.DateTime]::UtcNow.Ticks)]
    #[var revBuild  = $([System.TimeSpan]::FromTicks($([MSBuild]::Subtract(#[var tNow], #[var tStart]))).TotalMinutes.ToString("0"))]
    #[var v         = #[var v].$([MSBuild]::Modulo(#[var revBuild], $([System.Math]::Pow(2, 14))))]
}]

#[File write("#[var log]"):> Example #[var v]\r\n\t Generated by vsSolutionBuildEvent]
#[IO scall("notepad", "#[var log]")]

$(n = $([System.Math]::Exp( $([MSBuild]::Multiply('$([System.Math]::Log(2))', 16).ToString().Replace(',', '.')) ).ToString("0")))
$(n)
```

If you have some problems with syntax and documentation for component can't say how this should be... don't worry, you can:

* See available Unit-tests for component: [vsSolutionBuildEventTest/SBEScripts/Components/](https://github.com/3F/vsSolutionBuildEvent/tree/master/vsSolutionBuildEventTest/SBEScripts/Components)
* Or, just [create new Issue](https://bitbucket.org/3F/vssolutionbuildevent/issues/new) - we are help you!

# Arguments

{% include elem/fillme %}

## Object type

The object type is new type for work with complex mixed data. Initially it was implemented special for [vsCommandEvent](http://vsce.r-eg.net).

*The vsSBE users should see this starting with v0.12.5+*

Value can be from all available scalar types + complex, like this:

```java
{}
{"str", true}
{"str", {1, 'y', {-12.457f}}, true}
```
etc.

## Dom & Code Completion

With latest versions we use [Dom](../../Dev/New Component/) for inspecting model of SBE-Scripts core. You can see all available features with code completion (Intellisense) in editor.

*Note: Current Wiki sections written manually. It means that current info about components may contain a some typo etc. 
Just use code completion in program and this for additional help. Later it can be generated automatically with additional utility from our Dom.*

## Work from other Modes

All [available modes](../../Modes/) should provide support of this engine. Moreover, in [C# Mode](../../Modes/CSharp/#work-with-msbuild-amp-sbe-scripts-engine) you can also use engine **directly** as you want!

However, **If** you want to **work directly with engine**, you should remember about protection of evaluation from used strings:

* All elements inside quotes (`"..."`, `'...'`) will be automatically protected from evaluation.

*If you work with standard options, you also should remeber this - [Dynamic evaluation with both engines MSBuild & SBE-Scripts](../../Features/Strings/#dynamic-evaluation-with-both-engines-msbuild-amp-sbe-scripts)*

### What to do if really need evaluation for direct using of engine

Use any convenient variants to avoid the using inside quotes or use **also** SBE-Scripts for using quotes.

For example, for [C# Mode](../../Modes/CSharp/):

* With [MSBuild Property Functions](http://msdn.microsoft.com/en-us/library/vstudio/dd633440%28v=vs.120%29.aspx):

```csharp 

string type = $([System.String]::Format('"{0}";', #[Build type]))
```

* With [UserVariableComponent](../SBE-Scripts/Components/UserVariableComponent/)

```csharp 

#[var _type = "#[Build type]"]
...
string type = #[var _type];
```

* With User-variables *(MSBuild or SBE-Scripts)*:

```csharp 

$(q = '"')
.. .
string type = $(q)#[Build type]$(q);
```

and others..

As result for all above you should see, for example:

```csharp

string type = "Rebuild";
```

## New Components for SBE-Scripts core

* [How to create Component in 5min](../../Dev/New Component/) ([Developer Zone](../../Dev/))

# References

* [Examples & Features](../../Examples/)
* [MSBuild](../MSBuild/)
* [Operations with strings](../../Features/Strings/)
* [Available modes](../../Modes/)
    * [C# Mode](../../Modes/CSharp/)
