[Download/Скачать](https://sourceforge.net/projects/vssbe/files/latest/download) (SourceForge.net)                    
![statistic](http://vssbe.sourceforge.net/stat/)

*MS Visual Studio Gallery*:

* [0d1dbfd7-ed8a-40af-ae39-281bfeca2334](http://visualstudiogallery.msdn.microsoft.com/0d1dbfd7-ed8a-40af-ae39-281bfeca2334/)
* (deprecated) [a83c8d51-301c-40cc-bd03-9cb85f723a72](http://visualstudiogallery.msdn.microsoft.com/a83c8d51-301c-40cc-bd03-9cb85f723a72)

```
#!text
```

# Visual Studio. Solution Build Event (vsSBE). What is it ?

This extension for additional event handling **to all subprojects at once in solution**. This feature is not provided by default for solution  ( only for individual projects, e.g. with a MSVS2010Pro SP1 ) :(

Designed for MS Visual Studio 2010 Professional, but you can try on other versions if that is still needed...

* Visual Studio 2012
* Visual Studio 2013

![screen-0.2](https://bitbucket.org/3F/vssolutionbuildevent/downloads/screen1_v0.2.2.png)

# Changes

* [Change List](Change List)


# Example of using

* Install latest build release **[vsSolutionBuildEvent.vsix](https://sourceforge.net/projects/vssbe/files/latest/download)** and restart your VS IDE
* After installing you have opportunity to add/change settings for your solution:

![menu item 0.2](https://bitbucket.org/3F/vssolutionbuildevent/downloads/vs_item_menu_0.2.png)

![interpreter mode](https://bitbucket.org/3F/vssolutionbuildevent/downloads/0.2.2_screen1.png)![files mode](https://bitbucket.org/3F/vssolutionbuildevent/downloads/0.2.2_screen2.png)

The settings are stored in the solution directory as **.xprojvsbe** (you can also ignore from repo with your scm(.gitignore, etc.,))

# Example of solving some problem
If you have a many subprojects in your solution as here:

![illustration of subprojects list](https://bitbucket.org/3F/vssolutionbuildevent/downloads/screen_projects_list.png)

and you want to manually updating something file at start build... e.g: **revision.h**

```
#!c++
// generated by revision.bat 
#ifndef REVISION_H
  #define REVISION_STR "31 [support-tmp::4b9a0cf]"
  #define L_REVISION_STR L"31 [support-tmp::4b9a0cf]"
#endif 
```

revision.bat:

```
#!bash
  : rev count
  FOR /F %%i IN ('git rev-list HEAD --count') DO set git_rev_count=%%i
  : rev SHA1 short
  FOR /F %%i IN ('git rev-parse --short HEAD') DO set git_rev_sha1=%%i
...
```

You can create **revision.vbs**:

```
#!vbscript

ret = MsgBox("Do you want to update revision.h ?", vbYesNo + vbQuestion, "Pre-Build Event :: Updating version")

If ret = vbYes Then
    Set shell = WScript.CreateObject("WScript.Shell")
    code = shell.Run("revision.bat", 1, true)
    If code <> 0 Then
        MsgBox "The script exited with code: " & code, vbOKOnly + vbExclamation, "Pre-Build Event :: Updating version"
    End If
End If
```

Click settings and select "**Pre-Build**" Solution. Write for example:

```
#!bash

revision.vbs
```

and that's all.. you can use a regular build solution with your scripts:

![vbs handling](https://bitbucket.org/3F/vssolutionbuildevent/downloads/screen_projects_vbs.png)

You can also write a multi-line script (Do not use a single-line comment):

```
#!bash

... 
for /F "tokens=2 delims=<" %%l in ('findstr /r "cshelp.*=.*\"[^\"]*" *.html') do ( 
    set line=%%l 
    set /a pos=%search_after% 
    set token_pos=!pos! 
    call :handler 
) 
...
```

or use any other interpreter as php, PowerShell, Wscript, Node.js, etc.

e.g.: easy sending email after complete building:

```
#!php

mail('yourmail@example.com', 'Build completed', date('H:i:s'));
```
or something else


```
#!java

/* Do not use a single-line comment */ 
 
/* range of 11000 - 11999 */ 
$rangeBegin = 11000; 
 
/* ... */ 
class GArtefacts 
{ 
    /* ... */   
    public function render() 
    { 
         try{ 
            $db = new PDO(Factory::sqlite("positions.db")); 
            $db->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION); 
 
            $res = $db->query("SELECT * FROM exports"); 
            while($row = $res->fetchObject()){ 
                Stripper::pack($row->dtmX, $row->dtmY, $row->dtmZ); 
            } 
        } 
        catch(Exception $e){ 
            $this->_msg('Error: ' . $e->getMessage()); 
        } 
    } 
} 
 
$ga = new GArtefacts(); 
$ga->render();
```
 ...

# MSBuild environment variables (properties)

available with **v0.3**

**Syntax:**


```
#!bash

$(name)
$(name:project) - properties from selected project in your solution
```
Escape symbol is a **$**: 

```
#!bash

$$(name) ... $$(name:project)
```

![UI-helper](https://bitbucket.org/3F/vssolutionbuildevent/downloads/env_variables.png)

This feature provided with a UI-helper.

You may:

* Selecting an specific project from list for a different value of variable
* Use a filter for quick access to variable
* Press [ENTER] for select and insert into the main window or use double click
* Disable this feature: uncheck this option in main windows and click [Apply] 

 Access to assistant:

* [CTRL] + [SPACE] when a typing commands...
* Press button - [MSBuild Properties] on main form
* [ESCAPE] terminate assistant 

## Example with a MSBuild variables

* File Mode:

```
#!bash

vssbe_h.bat PRE $(Configuration)
```

* vssbe_h.bat:


```
#!bash

@echo off
REM arguments:

    REM event type:
    set etype=%1
    REM configuration name:
    set cfgname=%2

REM ### Event handling #

goto :Event_%etype%

REM ### Pre-Build

    :Event_PRE
        if "%cfgname%" == "Release" (
            revision.vbs
        )
    goto end

REM ### Post-Build

    :Event_POST
    goto end

REM ### Cancel-Build

    :Event_CANCEL
    goto end

:end
```

# [other screenshots](screenshots)