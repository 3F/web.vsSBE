# Visual Studio. Solution Build Event (vsSBE). What is it ?

This extension for additional event handling **to all subprojects at once in solution**. This feature is not provided by default for solution  ( e.g. MSVS2010Pro SP1), **[only for individual projects](https://bitbucket.org/3F/vssolutionbuildevent/downloads/standard_build_events.png)** :(

Designed for MS Visual Studio 2010 Professional, but you can try on other versions if you needed...

* Visual Studio 2012
* Visual Studio 2013

# Changes 

## v0.2.2 

* [enhancement] advanced control of events 
* [enhancement] New modes: interpreter & files mode
* [fix] vsix. removed restrictions on products
* [fix] #152 change slashes (/ to \) for relative paths
* minor UI changes
 
![interpreter mode](https://bitbucket.org/3F/vssolutionbuildevent/downloads/0.2.2_screen1.png)


# Example of using

* Install latest build release **[vsSolutionBuildEvent.vsix](https://sourceforge.net/projects/vssbe/files/latest/download)** and restart your VS IDE
* After installing you have opportunity to add/change settings for your solution:

![menu item](https://bitbucket.org/3F/vssolutionbuildevent/downloads/screen_menu_item.png)

![screen1](https://bitbucket.org/3F/vssolutionbuildevent/downloads/screen1.png)

The settings are stored in the solution directory as **.xprojvsbe** (you can also ignore from repo with your scm(.gitignore, etc.,))

# Example of solving some problem
If you have a many subprojects in your solution as here:

![illustration of subprojects list](https://bitbucket.org/3F/vssolutionbuildevent/downloads/screen_projects_list.png)

and you want to manually updating something file at start build... e.g: **revision.h**

```
#!c++
// generated by revision.bat 
#ifndef REVISION_H
  #define REVISION_STR "31 [support-tmp::4b9a0cf]"
  #define L_REVISION_STR L"31 [support-tmp::4b9a0cf]"
#endif 
```

revision.bat:

```
#!bash
  : rev count
  FOR /F %%i IN ('git rev-list HEAD --count') DO set git_rev_count=%%i
  : rev SHA1 short
  FOR /F %%i IN ('git rev-parse --short HEAD') DO set git_rev_sha1=%%i
...
```

You can create **revision.vbs**:

```
#!vbscript

ret = MsgBox("Do you want to update revision.h ?", vbYesNo + vbQuestion, "Pre-Build Event :: Updating version")

If ret = vbYes Then
    Set shell = WScript.CreateObject("WScript.Shell")
    code = shell.Run("revision.bat", 1, true)
    If code <> 0 Then
        MsgBox "The script exited with code: " & code, vbOKOnly + vbExclamation, "Pre-Build Event :: Updating version"
    End If
End If
```

Click settings and select "**Pre-Build**" Solution. Write for example:

```
#!bash

revision.vbs
```

and that's all.. you can use a regular build solution with your scripts:

![vbs handling](https://bitbucket.org/3F/vssolutionbuildevent/downloads/screen_projects_vbs.png)

You can also write a multi-line script (Do not use a single-line comment):

```
#!bash

... 
for /F "tokens=2 delims=<" %%l in ('findstr /r "cshelp.*=.*\"[^\"]*" *.html') do ( 
    set line=%%l 
    set /a pos=%search_after% 
    set token_pos=!pos! 
    call :handler 
) 
...
```

or use any other interpreter as php, PowerShell, Wscript, Node.js, etc.


# other screenshots

![screen-0.2](https://bitbucket.org/3F/vssolutionbuildevent/downloads/screen1_v0.2.2.png)

![files mode](https://bitbucket.org/3F/vssolutionbuildevent/downloads/0.2.2_screen2.png)

![logs](https://bitbucket.org/3F/vssolutionbuildevent/downloads/0.2.2_screen3.png)